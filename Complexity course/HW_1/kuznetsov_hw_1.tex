\documentclass[a4paper,12pt]{article}
\usepackage[cp1251]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{bbm}


\newtheorem{theorem}{Теорема}[section]
\newtheorem{lemma}[theorem]{Лемма}
\newtheorem{proposition}[theorem]{Предложение}
\newtheorem{claim}[theorem]{Утверждение}
\newtheorem{corollary}[theorem]{Следствие}

%opening
\title{Домашняя работа 1 --- Кузнецов}
\author{}
\date{}


\begin{document}
\maketitle


\section{Задание 1}
\begin{enumerate}
 \item C9. 2-SAT лежит в классе P. \\
 Иными словами, нужно построить полиномиальный алгоритм, который будет определять, выполнима ли данная КНФ.
 Пусть в 2-КНФ участвуют переменные $x_1, \ldots, x_n.$ Можно считать, что каждый дизъюнкт содержит ровно две переменные (иначе для выполнимости значения переменных, которые входят в некоторые конъюнкты в единственом числе, определены).
 Построим по данной 2-КНФ ориентированный граф таким образом. Вершинами графа будут точки, соответствующие
 $x_1, \ldots, x_n, \neg x_1, \ldots, \neg x_n$ (всего $2n$ вершин). Далее, каждый дизъюнкт $a\vee b$ можно переписать 
 как $\neg a \rightarrow b$ и $\neg b \rightarrow a$ (например, дизъюнкт $x_5 \vee \neg x_8$ можно записать в виде $\neg x_5 \rightarrow x_8$ и $x_8 \rightarrow x_5$). Поэтому для каждого дизъюнкта 
 $a \vee b$ проведём ориентированные рёбра из $\neg a$ в $b$ и из $\neg b$ в $a$ (мы считаем 
 $\neg\neg x_i=x_i$). Ясно, что если в построенном графе имеется путь из $a$ в $b$, то из истинности $a$ 
 следует истинность $b$. Поэтому, если есть путь из $x_i$ в $\neg x_i$, то $x_i$ не может быть истинной, 
 а если есть путь из $\neg x_i$ в $x_i$, то $x_i$ не может быть ложной. Следовательно, если для некоторой $x_i$ существует путь из $x_i$ в $\neg x_i$ и из $\neg x_i$ в $x_i$, то 2-КНФ невыполнима. 
 
  Покажем, что если ни для какого $i$ нет путей одновременно из $x_i$ в $\neg x_i$ и из $\neg x_i$ в $x_i$, 
  то формула выполнима. 
   Покажем это индукцией по числу переменных. Для одной переменной очевидно. Выполним индукционный переход от всех, меньших $n+1$, к $n+1$. Допустим, для $x_{n+1}$ нет пути из $x_{n+1}$ в $\neg x_{n+1}$ (случай, когда нет пути 
   из $\neg x_{n+1}$ в $x_{n+1}$, рассматривается аналогично). Тогда положим $x_{n+1}=1$ (мы считаем, что 0 - это Ложь, 1 - это Истина). Также положим равными $1$ значения всех точек, достижимых из $x_{n+1}$ (если 
   $\neg x_i$ достижима из $x_{n+1}$, то полагаем $x_i=0$). Мы не можем одновременно положить $x_p=1$ и
   $x_p=0$, потому что иначе есть пути из $x_{n+1}$ в $x_p$ и из $x_{n+1}$ в $\neg x_p$. Но если есть путь из
   $x_{n+1}$ в $x_p$, то, как легко видеть, есть и путь из $\neg x_p$ в $\neg x_{n+1}$. Поэтому есть путь из $x_{n+1}$ в $\neg x_{n+1}$ --- противоречие. Итак, для всех достижимых из $x_{n+1}$ точек определены значения. Но если $a$ достижима из $x_{n+1}$ и входит в дизъюнкцию $a \vee b$, то эту дизъюнкцию можно откинуть, поскольку при $a=1$ она истинна независимо от $b$. Если же $a$ входит в дизъюнкцию 
   $\neg a \vee b$, то $b$ достижима из $x_{n+1}$, и эта дизъюнкция тоже автоматически становится истинной, 
   и её тоже можно отбросить. Так мы приходим к 2-КНФ с меньшим числом переменных, в которой каждый дизъюнкт имеет ширину 2 (и для которо1 выполнено пред\-по\-ложение, что ни для какого $i$ нет путей одновременно из $x_i$ в $\neg x_i$ и из $\neg x_i$ в $x_i$). Итак, наше утверждение доказано.
   
   Осталось заметить, что выяснить, можно ли пройти из одной точки в другую в ориентированном графе, можно за полиномиальное время (нужно просто завести список вершин, которые достижимы за не более $k$ шагов из данной вершины, и увеличивать $k$, пока этот список не стабилизируется).
   
 \item C10. Полиномиальный алгоритм проверки выполнимости Хорновской формулы. \\
  Если в каждом дизъюнкте есть переменная с отрицанием, то формула выполнима --- можно положить все переменные равными 0. 
  Если есть дизъюнкт, в котором нет переменных с отрицанием, то там по условию только одна переменная, и она должна быть истинной. Фиксируем значение этой переменной и сводим задачу к задаче с меньшим числом переменных и меньшим числом дизъюнктов (при этом формула остаётся Хорновской). Легко видеть, что этот алгоритм полиномиален. 
  
  \item C1. 
  б) Проверить, что число единиц в строке из 0 и 1 делится на 3. 
  
   Для одноленточной машины Тьюринга: \\
  $q_0, 0 \rightarrow q_0, 0, \rightarrow$ \\
  $q_0, 1 \rightarrow q_1, 1, \rightarrow$ \\
  $q_1, 0 \rightarrow q_1, 0, \rightarrow$ \\
  $q_1, 1 \rightarrow q_2, 1, \rightarrow$ \\
  $q_2, 0 \rightarrow q_2, 0, \rightarrow$ \\
  $q_2, 1 \rightarrow q_0, 1, \rightarrow$ \\
  $q_0, \_ \rightarrow q_{yes}, \_, \leftarrow$ \\
  $q_1, \_ \rightarrow q_{no}, \_, \leftarrow$ \\
  $q_2, \_ \rightarrow q_{no},\_, \leftarrow$ \\
  
  $q_{no}, q_{yes}$ --- финальные состояния ($q_{yes}$ --- число единиц делится на 3, $q_{no}$ --- не делится). 
  
  в) $a-1$, если $a>0$, иначе $0$. Пусть $q$ --- начальное состояние, $q_f$ --- финальное. 
  Построим одноленточную машину Тьюринга. (Предполагаем, что лента бесконечна в одну сторону, и головка вначале стоит на начале ленты, и двоичное число написано тоже сначала ленты). \\
  $q, 0 \rightarrow q_f, 0, \rightarrow$ \\
  $q, 1 \rightarrow q_1, 1, \rightarrow$ \\
  $q_0, 0 \rightarrow q_0, 0, \rightarrow$ \\
  $q_0, 1 \rightarrow q_1, 1, \rightarrow$ \\
  $q_1, 0 \rightarrow q_0, 0, \rightarrow$ \\
  $q_1, 1 \rightarrow q_1, 1, \rightarrow$ \\
  $q_1, \_ \rightarrow q_3, \_, \leftarrow$ \\
  $q_3, 1 \rightarrow q_f, 0, \rightarrow$ \\
  $q_0, \_ \rightarrow q_2,\_, \leftarrow$ \\
  $q_2, 0 \rightarrow q_2, 1, \leftarrow$ \\
  $q_2, 1 \rightarrow q_f, 0, \rightarrow$ \\
  
  Недостатком данного решения является то, что, например, для \\ $a=1000_2$ ответ будет выведен в виде
  $0111_2$. Также не учтены отрицательныые числа. 
  
  \item C5. Язык из $P/poly \setminus P$.
  
  Сделаем вычислимую нумерацию всех машин Тьюринга и построим их в такой ряд: 
   $$T_1, T_1, T_2, T_1, T_2, T_3, T_1, T_2, T_3, T_4, \ldots$$
   Построим язык, принадлежность к которому слова определяется лишь длиной слова. Тогда, очевидно, этот язык будет лежать в $P/poly$.
   Строим этот язык таким способом: запускаем $n$-ю машину Тьюринга на входе $0^n$, и если она выводит за $n^n$ шагов ответ (0 или 1), мы для всех слов длины $n$ выводим противоположный ответ. Если она не останавливается за это число шагов, то для всех слов длины $n$ выводим $0$. 

 От машины Тьюринга, работающей время не более $Cn^K$, наш ответ отличается на входе $0^n$ при большом $n$. 
 Поскольку каждая машина Тьюринга в нашей нумерации встречается как угодно далеко, то наша функция не вычисляется никакой машиной Тьюринга, рабо\-та\-ющей время не более $Cn^K$. Следовательно, наш язык не входит 
 в $P$, хотя принадлежность к этому языку определяется вычислимой функцией. 
 
 \item C6. а) Вероятностная булева схема $C'$ с $n+m'$ входами. 
 Возьмём $N=Kp(n)$ ($K$ выберем позже) одинаковых схем $C$ и объединим их случайные биты в одну случайную строку $r'$ длины $Nm$. Тогда с большой вероятностью (по строке $r'$) для каждого фиксированного $x$ большая часть ответов наших $N$ схем $C$ будет совпадать с пра\-виль\-ными. Действительно, 
 рассмотрим (для фиксированного $x$) ответы наших схем как неза\-ви\-си\-мые бернул\-ли\-ев\-ские случайные величины с ве\-ро\-ят\-нос\-тью успеха $p \ge \frac{2}{3}$. 
 Тогда из нера\-вен\-ства Чернова (см. стр. 18 книги Roman Vershynin ``High-dimensional probability'') 
 получаем ($\mu=pN, t=N/2$, $S_N$ --- количество верных ответов):
 $$P\{S_N\le N/2\}\le e^{-\mu}\left(\frac{e\mu}{N/2}\right)^{N/2},$$
 $$P\{S_N\le N/2\}\le e^{-pN}\left(\frac{epN}{N/2}\right)^{N/2},$$
 $$P\{S_N\le N/2\}\le e^{-pN}(2ep)^{N/2},$$
 $$P\{S_N\le N/2\}\le (\sqrt{2e}\sqrt{pe^{-2p}})^{N}.$$
 Рассмотрим функцию $h(x)=xe^{-2x}.$ $h'(x)=(1-2x)e^{-2x}$, поэтому $h$ убывает при $x\ge \frac12$.
 Отсюда, поскольку $p\ge \frac23 > \frac12$:
 $$\sqrt{2e}\sqrt{pe^{-2p}}\le \sqrt{2e} \sqrt{\frac23 e^{-4/3}} = u < 1.$$
 Выберем $K$ так, чтобы 
 $$u^{Kp(n)}<2^{-p(n)},$$
 то есть $u^K<\frac12.$
 Итак, с вероятнотью больше $1-2^{-p(n)}$ большая часть ответов наших схем $C$ правильные. 
 Теперь достроим нашу схему так, чтобы ответом схемы был ответ, который выдают большая часть схем $C$.
 Это можно сделать, имитируя сортировку ``пузырьком''. Так, у нас есть строка из $N$ чисел 0 или 1, и нам надо вывести тот ответ, который встречается в этой строке наибольшее число раз. Для этого достроим некоторое количество строк, в каждой из которых будет находиться $N/2$ пар операторов ``максимум-минимум'', применённых к соседним числам в предыдущей строке, причём в строках с нечётными номерами мы будем применять операторы к парам чисел на местах $(1, 2)$, $(3, 4)$, ..., а в строках с чётными номерами --- к парам чисел $(2, 3)$, $(4, 5)$,... Ясно, что за некоторое (полиномиально ограниченное) количество таких строк мы получим отсортированную исходную строку из $0$ и $1$. И остаётся вывести в виде ответа число, которое стоит на середине этой строки.
 \item C7. Забывчивая машина Тьюринга. Для построения забывчивой машины Тьюринга нам понадобится больше лент. Для каждой ленты из наших $k$ лент заведём две новых ленты, на одной из которых (доп. лента-1) будем запоминать состояние машины Тью\-рин\-га, а на другой (доп. лента-2) - ставить единицу в нужные моменты (см. далее), и также заведём ленту $L$, где с самого начала запишем $T(n)$ единиц подряд (тут пробел в рассуждении --- не очевидно, что существует машина Тью\-рин\-га, которая с самого начала пишет $T(n)$ единиц подряд). 
 
 Двигаясь по ленте, мы будем каждый раз проходить расстояние $T(n)$ слева направо, а затем справа налево (чтобы понять, что мы прошли нужное расстояние и пора остановиться, надо посмотреть на ленту $L$). 
 При этом мы будем записывать на каждой из $k$ дополнительных лент-2 единичку в том месте, где исходная машина Тьюринга должна была сделать соответствующую данному шагу операцию, и если направление смещения головки совпадало с тем направлением, куда должна была переместиться головка у исходной машины Тьюринга, то мы выполняем эту операцию, а записываем на доп. ленту-2 единицу в месте, соответствующем уже новому положению исходной головки, и на доп. ленте-1 записываем это новое состояние исходной машины Тьюринга. А если направление смещения головки было противопо\-лож\-ным 
 исходной машине, то мы записываем единицу на соответствующее место доп. ленты-2 (и запоминаем состояние на доп. ленте-1)
 и оставляем выполнение этой операции на следующий проход (новой) машины Тьюринга в противоположном направлении. 
 
\end{enumerate}
 

\end{document}
